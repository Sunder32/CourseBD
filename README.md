
# –ë–∞–∑–∞ –¥–∞–Ω–Ω—ã—Ö –¥–ª—è —Å–µ—Ä–≤–∏—Å–∞ –∞—Ä–µ–Ω–¥—ã —ç–ª–µ–∫—Ç—Ä–æ—Å–∞–º–æ–∫–∞—Ç–æ–≤  
![ER-–¥–∏–∞–≥—Ä–∞–º–º–∞](erd.png)


+ [–¢–∏–ø–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã](#—Ç–∏–ø–æ–≤—ã–µ-–∑–∞–ø—Ä–æ—Å—ã)  
- [View-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è](#view-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è)  
* [–•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã](#—Ö—Ä–∞–Ω–∏–º—ã–µ-–ø—Ä–æ—Ü–µ–¥—É—Ä—ã)  
+ [–¢—Ä–∏–≥–≥–µ—Ä—ã](#—Ç—Ä–∏–≥–≥–µ—Ä—ã)

> [!IMPORTANT]  
> ## –î–ª—è —Ä–∞–∑–≤—ë—Ä—Ç—ã–≤–∞–Ω–∏—è –ë–î –∏ —Ç–µ—Å—Ç–æ–≤—ã—Ö –¥–∞–Ω–Ω—ã—Ö –Ω–µ–æ–±—Ö–æ–¥–∏–º–æ —Å–∫–∞—á–∞—Ç—å –∏ –≤—ã–ø–æ–ª–Ω–∏—Ç—å —Ñ–∞–π–ª `dump.sql`

---

## üìå –¢–∏–ø–æ–≤—ã–µ –∑–∞–ø—Ä–æ—Å—ã:

### –î–æ—Å—Ç—É–ø–Ω—ã–µ —Å–∞–º–æ–∫–∞—Ç—ã —Å –∑–∞—Ä—è–¥–æ–º –≤—ã—à–µ 20%:

```sql
SELECT * FROM scooters
WHERE status = 'available' AND battery_level >= 20;
```

### –ë–∞–ª–∞–Ω—Å –∫–æ–Ω–∫—Ä–µ—Ç–Ω–æ–≥–æ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
SELECT user_id, username, balance
FROM users
WHERE username = 'alice';
```

### –ê–∫—Ç–∏–≤–Ω–∞—è –∞—Ä–µ–Ω–¥–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
SELECT * FROM rentals
WHERE user_id = 1 AND status = 'active';
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
SELECT COUNT(*) AS total_rentals,
       SUM(distance) AS total_km,
       SUM(cost) AS total_cost
FROM rentals
WHERE user_id = 1 AND status = 'completed';
```

### –ò—Å—Ç–æ—Ä–∏—è –ø–ª–∞—Ç–µ–∂–µ–π –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è:

```sql
SELECT * FROM payments
WHERE user_id = 1
ORDER BY created_at DESC;
```

---

## üìä View-–ø—Ä–µ–¥—Å—Ç–∞–≤–ª–µ–Ω–∏—è:

### –ê–∫—Ç–∏–≤–Ω—ã–µ –∞—Ä–µ–Ω–¥—ã:

```sql
SELECT * FROM active_rentals;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—é:

```sql
SELECT * FROM user_rental_summary;
```

### –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –ø–æ –∫–∞–∂–¥–æ–º—É —Å–∞–º–æ–∫–∞—Ç—É:

```sql
SELECT * FROM scooter_usage_stats;
```

---

## ‚öôÔ∏è –•—Ä–∞–Ω–∏–º—ã–µ –ø—Ä–æ—Ü–µ–¥—É—Ä—ã:

### –ü–æ–ø–æ–ª–Ω–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞:

```sql
CALL top_up_balance(1, 200.00);
```

### –ù–∞—á–∞–ª–æ –∞—Ä–µ–Ω–¥—ã:

```sql
CALL start_rental(1, 2);
```

### –ó–∞–≤–µ—Ä—à–µ–Ω–∏–µ –∞—Ä–µ–Ω–¥—ã —Å –ø–µ—Ä–µ–¥–∞—á–µ–π –¥–∏—Å—Ç–∞–Ω—Ü–∏–∏ (–≤ –∫–º):

```sql
CALL end_rental(1, 3.5);
```

---

## üîÑ –¢—Ä–∏–≥–≥–µ—Ä—ã:

### –û–±–Ω–æ–≤–ª–µ–Ω–∏–µ –±–∞–ª–∞–Ω—Å–∞ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è –ø—Ä–∏ –ª—é–±–æ–º –ø–ª–∞—Ç–µ–∂–µ:

```sql
-- trg_update_user_balance (AFTER INSERT ON payments)
```

### –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–µ—Ä–µ–∫–ª—é—á–µ–Ω–∏–µ —Å—Ç–∞—Ç—É—Å–∞ —Å–∞–º–æ–∫–∞—Ç–∞ –≤ ‚Äúrented‚Äù –ø—Ä–∏ –Ω–∞—á–∞–ª–µ –∞—Ä–µ–Ω–¥—ã:

```sql
-- trg_update_scooter_status_on_rental (AFTER INSERT ON rentals)
```

### –û—Å–≤–æ–±–æ–∂–¥–µ–Ω–∏–µ —Å–∞–º–æ–∫–∞—Ç–∞ –ø–æ—Å–ª–µ –∑–∞–≤–µ—Ä—à–µ–Ω–∏—è –∞—Ä–µ–Ω–¥—ã:

```sql
-- trg_free_scooter_on_rental_end (AFTER UPDATE ON rentals)
```
